const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CategoryManagerModal-Y2XWxZFQ.js","assets/index-KKYn1hr3.js","assets/vendor-B7FnPyzq.js","assets/index-DyUq36P8.css","assets/search-VDh8cpI3.js","assets/TagManagerModal-FhqAE-WG.js"])))=>i.map(i=>d[i]);
import{c as ne,r as c,j as e,X as ue,G as te,L as V,E as Ne,a as ze,d as H,b as we,P as xe,B as be,N as ye,I as pe,F as Ce,T as ke,C as Se,e as ae,D as he,f as ee,g as re,h as Le,R as _e,U as Me,i as Ie,k as De,l as Te,m as me,_ as fe}from"./index-KKYn1hr3.js";import{s as Ee}from"./storage-CLUXANlV.js";import{W as de,A as oe}from"./webhook-DSg7e7IG.js";import{H as le}from"./hard-drive-CgeX8fma.js";import{S as ce}from"./server-B0p-S84h.js";import{h as Re,C as Pe}from"./index-jRiquA6t.js";import{A as Ae}from"./arrow-left-DJBOZ_Mh.js";import{T as P,a as A}from"./toggle-right-DtmSQQHv.js";import"./vendor-B7FnPyzq.js";/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],$e=ne("cloud",Oe);/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["path",{d:"M18 5a2 2 0 0 1 2 2v8.526a2 2 0 0 0 .212.897l1.068 2.127a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45l1.068-2.127A2 2 0 0 0 4 15.526V7a2 2 0 0 1 2-2z",key:"1pdavp"}],["path",{d:"M20.054 15.987H3.946",key:"14rxg9"}]],Be=ne("laptop",Ue);/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Fe=ne("log-out",We);/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Ge=ne("shield",He),ge=({name:x,svgData:z,className:s="w-5 h-5",containerClassName:i="w-8 h-8"})=>{const[w,k]=c.useState(!1);if(c.useEffect(()=>k(!1),[x]),z)return e.jsx("div",{className:`${i} rounded bg-zinc-800 flex items-center justify-center overflow-hidden border border-zinc-700 bg-white/5`,children:e.jsx("span",{className:`${s} flex items-center justify-center dashboard-icon-svg`,dangerouslySetInnerHTML:{__html:z},style:{display:"flex"}})});if(x&&!w){const S=`https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/svg/${x.trim().toLowerCase().replace(/\s+/g,"-")}.svg`;return e.jsx("div",{className:`${i} rounded bg-zinc-800 flex items-center justify-center overflow-hidden border border-zinc-700 bg-white/5`,children:e.jsx("img",{src:S,alt:x,className:`${s} object-contain`,onError:()=>k(!0)})})}return e.jsx("div",{className:`${i} rounded bg-zinc-800 flex items-center justify-center text-zinc-500`,children:e.jsx(de,{size:16})})},Ve=async x=>{if(!x)return null;const z=x.trim().toLowerCase().replace(/\s+/g,"-");try{const s=`https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/svg/${z}.svg`,i=await fetch(s);if(i.ok)return await i.text()}catch(s){console.warn(`Failed to fetch icon for ${z}`,s)}return null},se={google_drive:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="m38.7 419.3 22.6 39c4.7 8.2 11.4 14.7 19.4 19.4l80.6-139.6H0c0 9.1 2.3 18.2 7 26.4z" style="fill:#0066da"/><path d="M256 173.9 175.4 34.3c-7.9 4.7-14.7 11.1-19.4 19.4L7 311.7c-4.6 8-7 17.1-7 26.4h161.3z" style="fill:#00ac47"/><path d="M431.4 477.7c7.9-4.7 14.7-11.1 19.4-19.4l9.4-16.1 44.9-77.7c4.7-8.2 7-17.3 7-26.4H350.7l34.3 67.4z" style="fill:#ea4335"/><path d="m256 173.9 80.6-139.6c-7.9-4.7-17-7-26.4-7H201.8c-9.4 0-18.5 2.6-26.4 7z" style="fill:#00832d"/><path d="M350.7 338.1H161.3L80.6 477.7c7.9 4.7 17 7 26.4 7h298c9.4 0 18.5-2.6 26.4-7z" style="fill:#2684fc"/><path d="M430.5 182.7 356 53.7c-4.7-8.2-11.4-14.7-19.4-19.4L256 173.9l94.7 164.2h161c0-9.1-2.3-18.2-7-26.4z" style="fill:#ffba00"/></svg>',onedrive:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="-0.01 91.97 512.15 328.03"><path d="m195.2 183.1 107.5 64.4 64-27c13-5.6 27-8.5 41.2-8.5 2.4 0 4.7.1 7 .3-21.8-85.6-109-137.2-194.6-115.3-38.5 9.9-72 33.8-93.9 67h1.6c23.7 0 47 6.6 67.2 19.1" style="fill:#0364b8"/><path d="M195.2 183.1C175 170.6 151.7 164 128 164h-1.6C55.7 164.9-.9 222.9 0 293.6c.3 25.6 8.3 50.6 23 71.6l94.8-39.9 42.1-17.7 93.8-39.5 49-20.6z" style="fill:#0078d4"/><path d="M415 212.3c-2.3-.2-4.7-.3-7-.3-14.2 0-28.2 2.9-41.2 8.5l-64 27 18.6 11.1 60.9 36.5 26.6 15.9 90.8 54.4c27.2-50.6 8.3-113.6-42.2-140.9-13.3-7.1-27.7-11.2-42.5-12.2" style="fill:#1490df"/><path d="m408.7 311-26.6-15.9-60.9-36.5-18.6-11.1-49 20.6-93.8 39.5-42.1 17.7L23 365.2C46.9 399.6 86.1 420 128 420h280c38.2 0 73.4-21 91.6-54.6z" style="fill:#28a8ea"/></svg>',dropbox:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 17.5 512 477.1"><path d="M150.9 17.5 0 115.3l105.1 84.5L256 105.7zM0 282l150.9 99L256 292.8l-150.9-93zm256 10.8L362.3 381 512 283.2l-103.8-83.3c0-.1-152.2 92.9-152.2 92.9m256-177.5L362.3 17.5 256 105.7l152.2 94.2zM257.2 312.2l-106.3 88.2-44.7-30.2V404l150.9 90.6L408 404v-33.8l-45.9 30.2c.2-.1-104.9-88.2-104.9-88.2" style="fill:#007ee5"/></svg>',icloud:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.38 0.75 79.33 50.97"><path d="M45.864.751a21.52 21.52 0 0 0-18.736 11.014 11.8 11.8 0 0 0-5.152-1.192 11.804 11.804 0 0 0-11.621 9.916A16.255 16.255 0 0 0 .378 35.482a16.255 16.255 0 0 0 16.263 16.24 16 16 0 0 0 2.039-.148h45.188a15.13 15.202 0 0 0 .713.035 15.13 15.202 0 0 0 .679-.035h1.082v-.08a15.13 15.202 0 0 0 13.361-15.087v-.03a15.13 15.202 0 0 0-12.317-14.9A21.52 21.52 0 0 0 45.864.751" style="fill:#3e82f4"/></svg>'},qe=({initialConfig:x,onSave:z,onClose:s})=>{var Q,X,_,M,B,W,D,o,F;const[i,w]=c.useState(x||{id:crypto.randomUUID(),name:"",type:"s3",endpoint:"",active:!0,credentials:{}}),[k,u]=c.useState(!1),[S,j]=c.useState(null),[f,L]=c.useState("idle"),[O,q]=c.useState("google_drive");c.useEffect(()=>{x&&["google_drive","dropbox","onedrive","icloud"].includes(x.type)&&q(x.type)},[x]);const b=(n,r)=>{w(d=>({...d,[n]:r}))},v=(n,r)=>{w(d=>({...d,credentials:{...d.credentials,[n]:r}}))},K=async()=>{u(!0),j(null);try{await Ee.testConnection(i),j({success:!0,msg:"Connection Verified & Ready."})}catch(n){j({success:!1,msg:n.message||"Connection Failed"})}finally{u(!1)}},J=n=>{n.preventDefault(),z(i)},$=async()=>{if(i.name&&!se[i.type]){const n=await Ve(i.name);n&&b("iconSvg",n)}},ie=()=>{var p;const n=(p=i.credentials)==null?void 0:p.clientId;if(!n){alert("Please enter Client ID first.");return}const r=window.location.origin,d=`notesdb_${crypto.randomUUID()}`;let g="";if(i.type==="google_drive")g=`https://accounts.google.com/o/oauth2/v2/auth?client_id=${n}&redirect_uri=${r}&response_type=code&scope=https://www.googleapis.com/auth/drive.file&access_type=offline&prompt=consent&state=${d}`;else if(i.type==="dropbox")g=`https://www.dropbox.com/oauth2/authorize?client_id=${n}&redirect_uri=${r}&response_type=code&state=${d}&token_access_type=offline`;else if(i.type==="onedrive")g=`https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=${n}&response_type=code&redirect_uri=${r}&response_mode=query&scope=Files.ReadWrite.AppFolder offline_access User.Read&state=${d}`;else if(i.type==="icloud"){alert("iCloud OAuth requires specific Apple Developer setup.");return}if(g){L("waiting");const m=600,T=700,E=window.screen.width/2-m/2,R=window.screen.height/2-T/2;window.open(g,"notesdb_oauth",`width=${m},height=${T},top=${R},left=${E}`)}};c.useEffect(()=>{const n=async r=>{var d;if(r.origin===window.location.origin&&((d=r.data)==null?void 0:d.type)==="NOTESDB_OAUTH_RESPONSE"){const{code:g,error:p}=r.data;if(p){j({success:!1,msg:`OAuth Error: ${p}`}),L("idle");return}if(g){L("exchanging");try{await Z(g),L("success"),j({success:!0,msg:"Connected Successfully!"})}catch(m){j({success:!1,msg:`Token Exchange Failed: ${m.message}`}),L("idle")}}}};return window.addEventListener("message",n),()=>window.removeEventListener("message",n)},[i.type,(Q=i.credentials)==null?void 0:Q.clientId,(X=i.credentials)==null?void 0:X.clientSecret]);const Z=async n=>{var E,R;const r=(E=i.credentials)==null?void 0:E.clientId,d=(R=i.credentials)==null?void 0:R.clientSecret,g=window.location.origin;let p="",m="",T={"Content-Type":"application/x-www-form-urlencoded"};if(i.type==="google_drive"?(p="https://oauth2.googleapis.com/token",m=new URLSearchParams({code:n,client_id:r,client_secret:d,redirect_uri:g,grant_type:"authorization_code"})):i.type==="dropbox"?(p="https://api.dropbox.com/oauth2/token",m=new URLSearchParams({code:n,grant_type:"authorization_code",client_id:r,client_secret:d,redirect_uri:g})):i.type==="onedrive"&&(p="https://login.microsoftonline.com/common/oauth2/v2.0/token",m=new URLSearchParams({client_id:r,scope:"Files.ReadWrite.AppFolder offline_access",code:n,redirect_uri:g,grant_type:"authorization_code",client_secret:d})),p){const Y=await fetch(p,{method:"POST",headers:T,body:m}),I=await Y.json();if(!Y.ok)throw new Error(I.error_description||I.error||"Token exchange failed");v("accessToken",I.access_token),I.refresh_token&&v("refreshToken",I.refresh_token)}},U=n=>{q(n);const r={type:n};n==="google_drive"?(r.name="Google Drive",r.endpoint="https://www.googleapis.com/upload/drive/v3/files"):n==="dropbox"?(r.name="Dropbox",r.endpoint="https://content.dropboxapi.com/2/files/upload"):n==="onedrive"?(r.name="OneDrive",r.endpoint="https://graph.microsoft.com/v1.0/me/drive/items"):n==="icloud"&&(r.name="iCloud Drive",r.endpoint="https://api.apple-cloudkit.com/database/1/"),se[n]&&(r.iconSvg=se[n]),w(d=>({...d,...r}))},y=[{id:"google_drive",label:"GDrive",iconName:"Google Drive"},{id:"dropbox",label:"Dropbox",iconName:"Dropbox"},{id:"onedrive",label:"OneDrive",iconName:"Microsoft OneDrive"},{id:"icloud",label:"iCloud",iconName:"iCloud"}];return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"w-full max-w-lg bg-zinc-900 border border-zinc-800 rounded-xl shadow-2xl overflow-hidden flex flex-col animate-in zoom-in-95 duration-200 max-h-[90vh]",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-zinc-800 bg-zinc-900/50",children:[e.jsxs("h3",{className:"text-sm font-bold text-white flex items-center gap-2",children:[e.jsx(le,{size:16,className:"text-indigo-400"}),x?"Edit Storage Provider":"Add External Storage"]}),e.jsx("button",{onClick:s,className:"text-zinc-500 hover:text-white transition-colors",children:e.jsx(ue,{size:18})})]}),e.jsxs("form",{onSubmit:J,className:"p-6 space-y-4 overflow-y-auto custom-scrollbar",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>b("type","s3"),className:`p-2 rounded-lg border flex flex-col items-center gap-1 transition-all ${i.type==="s3"?"bg-indigo-500/10 border-indigo-500 text-indigo-400":"bg-black border-zinc-800 text-zinc-500 hover:border-zinc-700"}`,children:[e.jsx(ce,{size:18}),e.jsx("span",{className:"text-[9px] font-bold",children:"S3/MinIO"})]}),e.jsxs("button",{type:"button",onClick:()=>b("type","webdav"),className:`p-2 rounded-lg border flex flex-col items-center gap-1 transition-all ${i.type==="webdav"?"bg-indigo-500/10 border-indigo-500 text-indigo-400":"bg-black border-zinc-800 text-zinc-500 hover:border-zinc-700"}`,children:[e.jsx(te,{size:18}),e.jsx("span",{className:"text-[9px] font-bold",children:"WebDAV"})]}),e.jsxs("button",{type:"button",onClick:()=>b("type","custom_http"),className:`p-2 rounded-lg border flex flex-col items-center gap-1 transition-all ${i.type==="custom_http"?"bg-indigo-500/10 border-indigo-500 text-indigo-400":"bg-black border-zinc-800 text-zinc-500 hover:border-zinc-700"}`,children:[e.jsx(de,{size:18}),e.jsx("span",{className:"text-[9px] font-bold",children:"API"})]}),e.jsxs("button",{type:"button",onClick:()=>U("google_drive"),className:`p-2 rounded-lg border flex flex-col items-center gap-1 transition-all ${["google_drive","dropbox","onedrive","icloud"].includes(i.type)?"bg-indigo-500/10 border-indigo-500 text-indigo-400":"bg-black border-zinc-800 text-zinc-500 hover:border-zinc-700"}`,children:[e.jsx($e,{size:18}),e.jsx("span",{className:"text-[9px] font-bold",children:"Cloud"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Provider Name"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-black border border-zinc-700 rounded overflow-hidden",children:e.jsx(ge,{name:i.name,svgData:i.iconSvg,className:"w-5 h-5",containerClassName:"bg-transparent border-none"})}),e.jsx("input",{required:!0,value:i.name,onChange:n=>b("name",n.target.value),onBlur:$,className:"flex-1 bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none",placeholder:"e.g. My Storage"})]})]}),i.type==="s3"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Endpoint URL"}),e.jsx("input",{required:!0,value:i.endpoint,onChange:n=>b("endpoint",n.target.value),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none",placeholder:"https://play.min.io"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Bucket Name"}),e.jsx("input",{required:!0,value:i.bucket||"",onChange:n=>b("bucket",n.target.value),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none",placeholder:"bucket-name"})]}),e.jsxs("div",{className:"w-1/3 space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Region"}),e.jsx("input",{value:i.region||"",onChange:n=>b("region",n.target.value),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none",placeholder:"us-east-1"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Access Key"}),e.jsx("input",{required:!0,value:((_=i.credentials)==null?void 0:_.accessKey)||"",onChange:n=>v("accessKey",n.target.value),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none"})]}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Secret Key"}),e.jsx("input",{required:!0,type:"password",value:((M=i.credentials)==null?void 0:M.secretKey)||"",onChange:n=>v("secretKey",n.target.value),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none"})]})]})]}),i.type==="webdav"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Endpoint URL"}),e.jsx("input",{required:!0,value:i.endpoint,onChange:n=>b("endpoint",n.target.value),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none",placeholder:"https://cloud.example.com/remote.php/dav/files/user"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Username"}),e.jsx("input",{value:((B=i.credentials)==null?void 0:B.username)||"",onChange:n=>v("username",n.target.value),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none"})]}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Password / Token"}),e.jsx("input",{type:"password",value:((W=i.credentials)==null?void 0:W.password)||"",onChange:n=>v("password",n.target.value),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none"})]})]})]}),i.type==="custom_http"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Endpoint URL"}),e.jsx("input",{required:!0,value:i.endpoint,onChange:n=>b("endpoint",n.target.value),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none",placeholder:"https://your-server.com/api/upload"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"w-1/2 space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Auth Header"}),e.jsx("input",{value:i.customHeaderName||"Authorization",onChange:n=>b("customHeaderName",n.target.value),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none",placeholder:"Authorization"})]}),e.jsxs("div",{className:"w-1/2 space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Auth Token"}),e.jsx("input",{type:"password",value:((D=i.credentials)==null?void 0:D.token)||"",onChange:n=>v("token",n.target.value),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Response JSON Path"}),e.jsx("input",{value:i.responsePath||"",onChange:n=>b("responsePath",n.target.value),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none font-mono",placeholder:"e.g. url"})]})]}),["google_drive","dropbox","onedrive","icloud"].includes(i.type)&&e.jsxs("div",{className:"space-y-4 border border-zinc-800 rounded-lg p-3 bg-zinc-950/50",children:[e.jsx("div",{className:"flex gap-1 bg-black p-1 rounded-lg border border-zinc-800",children:y.map(n=>e.jsxs("button",{type:"button",onClick:()=>U(n.id),className:`flex-1 flex flex-col items-center gap-1 text-[10px] py-2 rounded font-bold transition-all ${i.type===n.id?"bg-zinc-800 text-white shadow-sm":"text-zinc-500 hover:text-zinc-300"}`,children:[e.jsx(ge,{name:n.iconName,svgData:se[n.id],className:"w-4 h-4",containerClassName:"w-6 h-6 flex items-center justify-center bg-transparent border-none"}),n.label]},n.id))}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Redirect URI"}),e.jsx("div",{className:"flex gap-2",children:e.jsx("input",{readOnly:!0,value:window.location.origin,className:"flex-1 bg-zinc-900 border border-zinc-800 rounded p-2 text-xs text-zinc-400 select-all font-mono"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Client ID (App Key)"}),e.jsx("input",{value:((o=i.credentials)==null?void 0:o.clientId)||"",onChange:n=>v("clientId",n.target.value),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none"})]}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Client Secret"}),e.jsx("input",{type:"password",value:((F=i.credentials)==null?void 0:F.clientSecret)||"",onChange:n=>v("clientSecret",n.target.value),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none"})]})]}),e.jsxs("button",{type:"button",onClick:ie,disabled:f==="waiting"||f==="exchanging"||f==="success",className:`w-full py-2 rounded text-xs font-bold flex items-center justify-center gap-2 transition-all ${f==="success"?"bg-emerald-500/20 text-emerald-500 cursor-default":"bg-white text-black hover:bg-zinc-200"}`,children:[f==="waiting"&&e.jsx(V,{size:14,className:"animate-spin"}),f==="exchanging"&&e.jsx(V,{size:14,className:"animate-spin"}),f==="idle"&&e.jsxs(e.Fragment,{children:["Connect to ",i.name,e.jsx(Ne,{size:12})]}),f==="waiting"&&"Waiting for Popup...",f==="exchanging"&&"Exchanging Token...",f==="success"&&"Connected!"]}),i.type==="icloud"&&e.jsx("p",{className:"text-[9px] text-zinc-500 italic text-center",children:"Note: iCloud requires advanced server-side signing. Direct client connection is experimental."})]}),(i.type==="s3"||i.type==="webdav")&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Public URL Prefix (Optional)"}),e.jsx("input",{value:i.publicUrlPrefix||"",onChange:n=>b("publicUrlPrefix",n.target.value),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none",placeholder:"https://cdn.example.com/files"})]}),e.jsx("div",{className:"pt-2 border-t border-zinc-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{type:"button",onClick:K,disabled:k,className:"text-xs text-indigo-400 hover:text-indigo-300 flex items-center gap-1 font-bold",children:[e.jsx(oe,{size:14,className:k?"animate-pulse":""}),"Test Connection"]}),S&&e.jsx("span",{className:`text-[10px] font-medium ${S.success?"text-emerald-500":"text-red-500"}`,children:S.msg})]})})]}),e.jsxs("div",{className:"p-4 bg-zinc-950 border-t border-zinc-800 flex justify-end gap-3",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-zinc-400 hover:text-white text-xs font-medium transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:J,className:"flex items-center gap-2 px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-xs font-bold transition-all shadow-lg shadow-indigo-900/20",children:["Save Provider",e.jsx(ze,{size:14})]})]})]})})},Ke=me.lazy(()=>fe(()=>import("./CategoryManagerModal-Y2XWxZFQ.js"),__vite__mapDeps([0,1,2,3,4]))),Je=me.lazy(()=>fe(()=>import("./TagManagerModal-FhqAE-WG.js"),__vite__mapDeps([5,1,2,3]))),G={smol:{id:"SmolLM2-135M-Instruct-q4f16_1-MLC",label:"SmolLM2 (135M)",size:"~100MB"},qwen:{id:"Qwen2.5-0.5B-Instruct-q4f16_1-MLC",label:"Qwen2.5-0.5B",size:"~400MB"}},as=({onBack:x,onSettingsChanged:z})=>{const[s,i]=c.useState(null),[w,k]=c.useState([]),[u,S]=c.useState("general"),[j,f]=c.useState(!1),[L,O]=c.useState(!1),[q,b]=c.useState(!1),[v,K]=c.useState(!1),[J,$]=c.useState(void 0),[ie,Z]=c.useState(!1),U=c.useRef(null),[y,Q]=c.useState(new Set),[X,_]=c.useState(""),[M,B]=c.useState(!1);c.useEffect(()=>{W(),"ai"in window&&f(!0),D()},[]);const W=async()=>{const[t,a]=await Promise.all([H.getSettings(),H.getTags()]);i(t),k(a)},D=async()=>{const t=new Set;for(const a in G)try{const l=G[a].id;await Re(l)&&t.add(a)}catch(l){console.warn(`Failed to check cache for ${a}`,l)}Q(t)},o=async t=>{i(t),await H.saveSettings(t),z()},F=()=>{W(),z()},n=()=>{if(!s)return;const t={id:crypto.randomUUID(),name:"New Webhook",url:"",triggerTagId:"",enabled:!0};o({...s,webhooks:[...s.webhooks,t]})},r=(t,a,l)=>{if(!s)return;const h=s.webhooks.map(N=>N.id===t?{...N,[a]:l}:N);o({...s,webhooks:h})},d=t=>{s&&o({...s,webhooks:s.webhooks.filter(a=>a.id!==t)})},g=()=>{if(!s)return;const t={id:crypto.randomUUID(),name:"CORS Proxy",url:"",enabled:!0};o({...s,proxyConfigs:[...s.proxyConfigs||[],t]})},p=(t,a,l)=>{if(!s)return;const h=(s.proxyConfigs||[]).map(N=>N.id===t?{...N,[a]:l}:N);o({...s,proxyConfigs:h})},m=t=>{s&&o({...s,proxyConfigs:(s.proxyConfigs||[]).filter(a=>a.id!==t)})},T=async t=>{if(!s)return;let a=[...s.storageConfigs];a.find(h=>h.id===t.id)?a=a.map(h=>h.id===t.id?t:h):a.push(t),await o({...s,storageConfigs:a}),O(!1),$(void 0)},E=t=>{!s||!confirm("Delete this storage provider?")||o({...s,storageConfigs:s.storageConfigs.filter(a=>a.id!==t)})},R=async()=>{if(!s)return;const t=s.aiConfig.webLlmModel||"smol",a=G[t];if(a){B(!0),_("Initializing engine...");try{await(await Pe(a.id,{initProgressCallback:h=>{_(h.text)}})).unload(),await D(),_("")}catch(l){_("Error: "+l.message),console.error(l)}finally{B(!1)}}},Y=async t=>{const a=G[t];if(a&&confirm(`Delete cached files for ${a.label}? This will free up ${a.size}.`))try{if("caches"in window){const h=(await caches.keys()).filter(N=>N.includes(a.id));h.length>0?await Promise.all(h.map(N=>caches.delete(N))):console.warn("No matching cache keys found for model ID:",a.id)}await D()}catch(l){console.error("Failed to delete model cache",l),alert("Failed to clear cache. Check console.")}},I=async()=>{const t=await H.createBackup(),a=URL.createObjectURL(t),l=document.createElement("a");l.href=a,l.download=`notesdb_backup_${new Date().toISOString().split("T")[0]}.zip`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)},je=async t=>{var l;const a=(l=t.target.files)==null?void 0:l[0];if(a&&confirm("This will OVERWRITE your current database. Continue?")){Z(!0);try{await H.restoreBackup(a),alert("Restore complete! Reloading..."),window.location.reload()}catch(h){alert(`Restore failed: ${h.message}`),Z(!1)}}},ve=()=>{if(confirm(`CRITICAL WARNING: This will DELETE ALL NOTES, CATEGORIES, TAGS, and SETTINGS from this browser.

This action cannot be undone.

Are you sure?`)){const t=indexedDB.deleteDatabase("NotesDB_v1");t.onsuccess=()=>window.location.reload(),t.onerror=()=>alert("Could not delete database. Please clear browser data manually."),t.onblocked=()=>alert("Reset blocked. Close other tabs of this app.")}};if(!s)return e.jsxs("div",{className:"p-8 text-zinc-500 flex items-center gap-2",children:[e.jsx(V,{className:"animate-spin"})," Loading settings..."]});const C=({id:t,label:a,icon:l})=>e.jsxs("button",{onClick:()=>S(t),className:`w-full flex items-center gap-3 px-4 py-2 rounded-lg transition-all text-left ${u===t?"bg-indigo-600 text-white shadow-lg shadow-indigo-900/20 font-bold":"text-zinc-400 hover:bg-zinc-800 hover:text-white"}`,children:[e.jsx(l,{size:18}),e.jsx("span",{children:a})]});return e.jsxs("div",{className:"flex h-full bg-black overflow-hidden animate-in fade-in duration-300",children:[e.jsxs(c.Suspense,{fallback:e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-[200]",children:e.jsx(V,{className:"animate-spin text-white"})}),children:[q&&e.jsx(Ke,{onClose:()=>b(!1),onUpdate:F}),v&&e.jsx(Je,{onClose:()=>K(!1),onUpdate:F})]}),e.jsxs("div",{className:"w-64 border-r border-zinc-800 bg-zinc-950 flex flex-col shrink-0",children:[e.jsxs("div",{className:"p-6 border-b border-zinc-800",children:[e.jsxs("button",{onClick:x,className:"flex items-center gap-2 text-zinc-400 hover:text-white transition-colors mb-4 text-xs font-bold uppercase tracking-wider",children:[e.jsx(Ae,{size:14})," Back to Dashboard"]}),e.jsxs("h1",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(we,{size:20,className:"text-indigo-500"})," Settings"]})]}),e.jsxs("nav",{className:"flex-1 p-4 space-y-2 overflow-y-auto",children:[e.jsx(C,{id:"general",label:"Organization",icon:xe}),e.jsx(C,{id:"ai",label:"AI Research Lab",icon:be}),e.jsx(C,{id:"cloud",label:"Cloud Sync",icon:te}),e.jsx(C,{id:"automation",label:"Webhooks",icon:de}),e.jsx(C,{id:"storage",label:"External Storage",icon:le}),e.jsx(C,{id:"proxies",label:"CORS Proxies",icon:ye}),e.jsx(C,{id:"security",label:"Security & Data",icon:Ge}),e.jsx("div",{className:"pt-4 mt-4 border-t border-zinc-800",children:e.jsx(C,{id:"about",label:"About NotesDB",icon:pe})})]}),e.jsx("div",{className:"p-4 border-t border-zinc-800 text-[10px] text-zinc-600 text-center",children:"NotesDB v1.2.7 â€¢ Local-First"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto space-y-8 pb-20 z-10",children:[u==="general"&&e.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsxs("section",{className:"space-y-8",children:[e.jsx("h2",{className:"text-lg font-bold text-white border-b border-zinc-800 pb-2",children:"Organization"}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Manage your taxonomy and classification systems."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>b(!0),className:"flex items-center gap-4 p-4 bg-zinc-900 border border-zinc-800 hover:border-indigo-500 hover:bg-zinc-800/80 rounded-xl transition-all group text-left",children:[e.jsx("div",{className:"p-3 bg-black rounded-lg text-indigo-500 group-hover:scale-110 transition-transform",children:e.jsx(Ce,{size:24})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-zinc-200",children:"Categories"}),e.jsx("p",{className:"text-xs text-zinc-500",children:"Manage folders & icons"})]})]}),e.jsxs("button",{onClick:()=>K(!0),className:"flex items-center gap-4 p-4 bg-zinc-900 border border-zinc-800 hover:border-pink-500 hover:bg-zinc-800/80 rounded-xl transition-all group text-left",children:[e.jsx("div",{className:"p-3 bg-black rounded-lg text-pink-500 group-hover:scale-110 transition-transform",children:e.jsx(ke,{size:24})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-zinc-200",children:"Tags"}),e.jsx("p",{className:"text-xs text-zinc-500",children:"Manage labels & colors"})]})]})]})]}),e.jsxs("section",{className:"space-y-8",children:[e.jsx("h2",{className:"text-lg font-bold text-white border-b border-zinc-800 pb-2",children:"Library layout"}),e.jsx("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-5 space-y-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-zinc-200",children:"Library View"}),e.jsx("p",{className:"text-xs text-zinc-500",children:"Enable visual carousel grid."})]}),e.jsx("button",{onClick:()=>o({...s,libraryMode:!s.libraryMode}),className:"text-indigo-400",children:s.libraryMode?e.jsx(P,{size:32}):e.jsx(A,{size:32,className:"text-zinc-600"})})]})})]}),e.jsxs("section",{className:"space-y-8",children:[e.jsx("h2",{className:"text-lg font-bold text-white border-b border-zinc-800 pb-2",children:"Editor Preferences"}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-5 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-zinc-200",children:"Library View"}),e.jsx("p",{className:"text-xs text-zinc-500",children:"Enable visual carousel grid."})]}),e.jsx("button",{onClick:()=>o({...s,libraryMode:!s.libraryMode}),className:"text-indigo-400",children:s.libraryMode?e.jsx(P,{size:32}):e.jsx(A,{size:32,className:"text-zinc-600"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-zinc-200",children:"Visual Editor"}),e.jsx("p",{className:"text-xs text-zinc-500",children:"Enable rich-text (TipTap) editing mode."})]}),e.jsx("button",{onClick:()=>o({...s,isEditorEnabled:!s.isEditorEnabled}),className:"text-indigo-400",children:s.isEditorEnabled?e.jsx(P,{size:32}):e.jsx(A,{size:32,className:"text-zinc-600"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-zinc-200",children:"Internal Link Trigger"}),e.jsx("p",{className:"text-xs text-zinc-500",children:"Character sequence to trigger note lookup."})]}),e.jsx("input",{type:"text",value:s.internalLinkTrigger||"[[",onChange:t=>o({...s,internalLinkTrigger:t.target.value}),className:"w-20 bg-black border border-zinc-700 rounded px-3 py-1.5 text-xs text-white focus:border-indigo-500 outline-none font-mono text-center",maxLength:2})]})]})]})]}),u==="ai"&&e.jsx("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-300",children:e.jsxs("section",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-zinc-800 pb-2",children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:"Agentic Research Lab"}),e.jsx("button",{onClick:()=>o({...s,aiConfig:{...s.aiConfig,enabled:!s.aiConfig.enabled}}),className:s.aiConfig.enabled?"text-emerald-400":"text-zinc-600",children:s.aiConfig.enabled?e.jsx(P,{size:32}):e.jsx(A,{size:32})})]}),s.aiConfig.enabled?e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-zinc-500 uppercase",children:"Provider Type"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all ${s.aiConfig.agenticSource==="browser"?"bg-indigo-500/10 border-indigo-500 text-indigo-300":"bg-black border-zinc-800 text-zinc-400 hover:border-zinc-700"}`,children:[e.jsx("input",{type:"radio",className:"hidden",checked:s.aiConfig.agenticSource==="browser",onChange:()=>o({...s,aiConfig:{...s.aiConfig,agenticSource:"browser"}})}),e.jsx(Se,{size:18}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-sm",children:"Browser Native"}),e.jsx("div",{className:"text-[10px] opacity-70",children:"Gemini Nano (Chrome)"})]})]}),e.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all ${s.aiConfig.agenticSource==="webllm"?"bg-indigo-500/10 border-indigo-500 text-indigo-300":"bg-black border-zinc-800 text-zinc-400 hover:border-zinc-700"}`,children:[e.jsx("input",{type:"radio",className:"hidden",checked:s.aiConfig.agenticSource==="webllm",onChange:()=>o({...s,aiConfig:{...s.aiConfig,agenticSource:"webllm"}})}),e.jsx(Be,{size:18}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-sm",children:"Local WebLLM"}),e.jsx("div",{className:"text-[10px] opacity-70",children:"Runs on your GPU (WASM)"})]})]}),e.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all ${s.aiConfig.agenticSource==="provider"?"bg-indigo-500/10 border-indigo-500 text-indigo-300":"bg-black border-zinc-800 text-zinc-400 hover:border-zinc-700"}`,children:[e.jsx("input",{type:"radio",className:"hidden",checked:s.aiConfig.agenticSource==="provider",onChange:()=>o({...s,aiConfig:{...s.aiConfig,agenticSource:"provider"}})}),e.jsx(te,{size:18}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-sm",children:"Cloud and Local API"}),e.jsx("div",{className:"text-[10px] opacity-70",children:"OpenAI, Ollama, LM Studio"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[s.aiConfig.agenticSource==="browser"&&e.jsxs("div",{className:"bg-black/50 rounded-lg p-3 border border-zinc-800 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${j?"bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.6)]":"bg-red-500"}`}),e.jsxs("span",{className:"text-xs font-bold text-zinc-300",children:["Status: ",j?"Detected (Gemini Nano)":"Not Detected"]})]}),!j&&e.jsxs("div",{className:"text-[10px] text-zinc-500 space-y-2 leading-relaxed",children:[e.jsx("p",{className:"font-bold text-zinc-400",children:"Setup Instructions (Chrome):"}),e.jsxs("ol",{className:"list-decimal pl-4 space-y-1",children:[e.jsxs("li",{children:["Open ",e.jsx("code",{children:"chrome://flags"})]}),e.jsxs("li",{children:["Enable ",e.jsx("strong",{children:"Prompt API for Gemini Nano"})]}),e.jsxs("li",{children:["Enable ",e.jsx("strong",{children:"Enables optimization guide on device"})]}),e.jsx("li",{children:"Relaunch Chrome"})]}),e.jsxs("div",{className:"pt-2 border-t border-zinc-800 mt-2",children:[e.jsx("span",{className:"text-indigo-400 font-bold",children:"Firefox:"})," Experimental support available in Nightly via ",e.jsx("code",{children:"about:config"})," (dom.origin-trials.enabled)."]})]}),j&&e.jsxs("p",{className:"text-[10px] text-emerald-500/80 flex items-center gap-1",children:[e.jsx(ae,{size:10})," Browser AI is ready to use."]})]}),s.aiConfig.agenticSource==="webllm"&&e.jsxs("div",{className:"bg-black/50 rounded-lg p-3 border border-zinc-800 space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Model Selection"}),e.jsxs("select",{value:s.aiConfig.webLlmModel||"smol",onChange:t=>o({...s,aiConfig:{...s.aiConfig,webLlmModel:t.target.value}}),className:"w-full bg-zinc-900 border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none",children:[e.jsx("option",{value:"smol",children:"SmolLM2-135M (100MB) - Extremely Fast"}),e.jsx("option",{value:"qwen",children:"Qwen2.5-0.5B (400MB) - Balanced"})]})]}),e.jsxs("div",{className:"flex gap-2 items-start text-[10px] text-zinc-500 bg-indigo-500/10 p-2 rounded border border-indigo-500/20",children:[e.jsx(pe,{size:14,className:"text-indigo-400 shrink-0 mt-0.5"}),e.jsx("p",{children:"Models run entirely in your browser using WebGPU. The first request will download the model to your browser cache."})]}),e.jsxs("div",{className:"pt-2",children:[e.jsxs("button",{onClick:R,disabled:M||y.has(s.aiConfig.webLlmModel||"smol"),className:`w-full flex items-center justify-center gap-2 py-2 rounded text-xs font-bold transition-all border ${y.has(s.aiConfig.webLlmModel||"smol")?"bg-emerald-500/10 text-emerald-400 border-emerald-500/20 opacity-80 cursor-default":"bg-zinc-800 text-white hover:bg-zinc-700 border-zinc-700"}`,children:[M?e.jsx(V,{size:14,className:"animate-spin"}):y.has(s.aiConfig.webLlmModel||"smol")?e.jsx(ae,{size:14}):e.jsx(he,{size:14}),M?"Downloading...":y.has(s.aiConfig.webLlmModel||"smol")?"Model Ready":"Download Model"]}),M&&e.jsx("p",{className:"text-[9px] text-indigo-300 mt-1 text-center font-mono animate-pulse",children:X})]}),e.jsxs("div",{className:"border-t border-zinc-800 pt-3 mt-3",children:[e.jsx("h4",{className:"text-[10px] font-bold text-zinc-500 uppercase mb-2",children:"Models Installed"}),e.jsxs("div",{className:"space-y-1",children:[Object.entries(G).map(([t,a])=>y.has(t)?e.jsxs("div",{className:"flex items-center justify-between p-2 bg-zinc-950 rounded border border-zinc-800",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-bold text-zinc-300",children:a.label}),e.jsx("div",{className:"text-[9px] text-zinc-600 font-mono",children:a.size})]}),e.jsx("button",{onClick:()=>Y(t),className:"p-1.5 text-zinc-500 hover:text-red-400 hover:bg-zinc-800 rounded transition-colors",title:"Delete Cache",children:e.jsx(ee,{size:14})})]},t):null),y.size===0&&e.jsx("p",{className:"text-[10px] text-zinc-600 italic text-center",children:"No models cached locally."})]})]})]}),s.aiConfig.agenticSource==="provider"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Base URL"}),e.jsx("input",{value:s.aiConfig.baseUrl,onChange:t=>o({...s,aiConfig:{...s.aiConfig,baseUrl:t.target.value}}),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none",placeholder:"https://api.openai.com/v1"}),e.jsxs("p",{className:"text-[9px] text-zinc-600",children:["Local: ",e.jsx("code",{children:"http://localhost:1234/v1"})," (LM Studio / Ollama). Ensure ",e.jsx("strong",{children:"/v1"})," is included if required by provider."]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"API Key (Optional for Local)"}),e.jsx("input",{type:"password",value:s.aiConfig.apiKey||"",onChange:t=>o({...s,aiConfig:{...s.aiConfig,apiKey:t.target.value}}),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none",placeholder:"sk-..."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Model Name"}),e.jsx("input",{value:s.aiConfig.model,onChange:t=>o({...s,aiConfig:{...s.aiConfig,model:t.target.value}}),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none",placeholder:"gpt-4o"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Custom Response Path (Optional)"}),e.jsx("input",{value:s.aiConfig.responseParserPath||"",onChange:t=>o({...s,aiConfig:{...s.aiConfig,responseParserPath:t.target.value}}),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none font-mono",placeholder:"choices[0].message.content"}),e.jsx("p",{className:"text-[9px] text-zinc-600",children:"JSON path to extraction the text response. Leave empty for auto-detect (OpenAI/Ollama)."})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-zinc-800",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Debug Mode"}),e.jsx("p",{className:"text-[9px] text-zinc-600",children:"Log raw provider responses to help troubleshoot invalid formats."})]}),e.jsx("button",{onClick:()=>o({...s,aiConfig:{...s.aiConfig,enableDebug:!s.aiConfig.enableDebug}}),className:s.aiConfig.enableDebug?"text-amber-400":"text-zinc-600",children:s.aiConfig.enableDebug?e.jsx(P,{size:24}):e.jsx(A,{size:24})})]})]})]})]}),e.jsxs("div",{className:"space-y-1 border-t border-zinc-800 pt-4",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"System Prompt (The Researcher)"}),e.jsx("textarea",{value:s.aiConfig.systemPrompt,onChange:t=>o({...s,aiConfig:{...s.aiConfig,systemPrompt:t.target.value}}),className:"w-full h-32 bg-black border border-zinc-700 rounded p-3 text-xs text-zinc-300 focus:border-indigo-500 outline-none resize-none leading-relaxed"})]})]}):e.jsxs("div",{className:"p-8 text-center border-2 border-dashed border-zinc-800 rounded-xl text-zinc-500",children:[e.jsx(be,{size:48,className:"mx-auto mb-4 opacity-20"}),e.jsx("p",{children:"Enable the Research Lab to activate AI analysis."})]})]})}),u==="cloud"&&e.jsx("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-300",children:e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-zinc-800 pb-2",children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:"Gist Sync & Backup"}),e.jsx("button",{onClick:()=>o({...s,syncConfig:{...s.syncConfig,enabled:!s.syncConfig.enabled}}),className:s.syncConfig.enabled?"text-indigo-400":"text-zinc-600",children:s.syncConfig.enabled?e.jsx(P,{size:32}):e.jsx(A,{size:32})})]}),s.syncConfig.enabled&&e.jsx("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-6 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Provider"}),e.jsxs("select",{value:s.syncConfig.provider,onChange:t=>o({...s,syncConfig:{...s.syncConfig,provider:t.target.value}}),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none",children:[e.jsx("option",{value:"github",children:"GitHub"}),e.jsx("option",{value:"gitea",children:"Gitea / Forgejo"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Personal Access Token"}),e.jsx("input",{type:"password",value:s.syncConfig.personalAccessToken||"",onChange:t=>o({...s,syncConfig:{...s.syncConfig,personalAccessToken:t.target.value}}),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none",placeholder:"ghp_..."})]}),s.syncConfig.provider==="gitea"&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-zinc-500",children:"Instance URL"}),e.jsx("input",{value:s.syncConfig.hostUrl||"",onChange:t=>o({...s,syncConfig:{...s.syncConfig,hostUrl:t.target.value}}),className:"w-full bg-black border border-zinc-700 rounded p-2 text-xs text-white focus:border-indigo-500 outline-none",placeholder:"https://git.example.com"})]})]})})]})}),u==="automation"&&e.jsx("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-300",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-bold text-white border-b border-zinc-800 pb-2",children:"Webhooks"}),e.jsx("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl overflow-hidden",children:e.jsxs("div",{className:"p-2 space-y-2",children:[s.webhooks.map(t=>e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-black/40 rounded border border-zinc-800/50",children:[e.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:t.name,onChange:a=>r(t.id,"name",a.target.value),className:"bg-transparent border-b border-transparent hover:border-zinc-700 focus:border-indigo-500 text-sm font-bold text-white outline-none w-1/3",placeholder:"Hook Name"}),e.jsx("input",{value:t.url,onChange:a=>r(t.id,"url",a.target.value),className:"bg-transparent border-b border-transparent hover:border-zinc-700 focus:border-indigo-500 text-xs text-zinc-400 outline-none flex-1 font-mono",placeholder:"https://discord.com/api/webhooks/..."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] text-zinc-500 uppercase font-bold",children:"Trigger:"}),e.jsxs("select",{value:t.triggerTagId,onChange:a=>r(t.id,"triggerTagId",a.target.value),className:"bg-zinc-900 border border-zinc-700 rounded text-[10px] text-zinc-300 px-2 py-1 outline-none",children:[e.jsx("option",{value:"",children:"Manual (All Notes)"}),w.map(a=>e.jsxs("option",{value:a.id,children:["Tag: ",a.name]},a.id))]})]})]}),e.jsx("button",{onClick:()=>r(t.id,"enabled",!t.enabled),className:`p-2 rounded-lg ${t.enabled?"text-green-400 bg-green-500/10":"text-zinc-600 bg-zinc-800"}`,children:e.jsx(oe,{size:16})}),e.jsx("button",{onClick:()=>d(t.id),className:"p-2 text-zinc-600 hover:text-red-400 hover:bg-red-500/10 rounded-lg",children:e.jsx(ee,{size:16})})]},t.id)),e.jsxs("button",{onClick:n,className:"w-full py-3 flex items-center justify-center gap-2 text-sm font-bold text-zinc-500 hover:text-white hover:bg-zinc-800 rounded-lg transition-colors border border-dashed border-zinc-800 hover:border-zinc-600",children:[e.jsx(re,{size:16})," Add Webhook"]})]})})]})}),u==="storage"&&e.jsx("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-300",children:e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-zinc-800 pb-2",children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:"Storage Providers"}),e.jsxs("button",{onClick:()=>O(!0),className:"text-xs font-bold text-indigo-400 hover:text-indigo-300 flex items-center gap-1 bg-indigo-500/10 px-3 py-1.5 rounded-lg border border-indigo-500/20",children:[e.jsx(re,{size:12})," Add Provider"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.storageConfigs.map(t=>e.jsxs("div",{className:"p-4 bg-zinc-900 border border-zinc-800 rounded-xl flex items-center justify-between group hover:border-zinc-700 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2.5 rounded-lg ${t.active?"bg-indigo-500/10 text-indigo-400":"bg-zinc-800 text-zinc-500"}`,children:e.jsx(ce,{size:20})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-white",children:t.name}),e.jsx("p",{className:"text-[10px] text-zinc-500 uppercase font-bold tracking-wider",children:t.type})]})]}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>{$(t),O(!0)},className:"p-2 text-zinc-400 hover:text-white hover:bg-zinc-800 rounded-lg",children:e.jsx(oe,{size:16})}),e.jsx("button",{onClick:()=>E(t.id),className:"p-2 text-zinc-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg",children:e.jsx(ee,{size:16})})]})]},t.id)),s.storageConfigs.length===0&&e.jsxs("div",{className:"col-span-2 text-center py-12 text-zinc-600 border-2 border-dashed border-zinc-800 rounded-xl",children:[e.jsx(le,{size:32,className:"mx-auto mb-2 opacity-20"}),e.jsx("p",{className:"text-xs",children:"No storage providers configured."})]})]})]})}),u==="proxies"&&e.jsx("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-300",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-bold text-white border-b border-zinc-800 pb-2",children:"CORS Proxies"}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl overflow-hidden p-2 space-y-2",children:[(s.proxyConfigs||[]).map(t=>e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-black/40 rounded border border-zinc-800/50",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-3",children:[e.jsx("input",{value:t.name,onChange:a=>p(t.id,"name",a.target.value),className:"bg-transparent border-b border-transparent focus:border-indigo-500 text-sm text-white outline-none font-bold",placeholder:"Proxy Name"}),e.jsx("input",{value:t.url,onChange:a=>p(t.id,"url",a.target.value),className:"bg-transparent border-b border-transparent focus:border-indigo-500 text-xs text-zinc-400 outline-none font-mono",placeholder:"https://cors.example.com/"}),e.jsx("input",{type:"password",value:t.token||"",onChange:a=>p(t.id,"token",a.target.value),className:"bg-transparent border-b border-transparent focus:border-indigo-500 text-xs text-zinc-400 outline-none font-mono",placeholder:"Auth Token (Optional)"})]}),e.jsx("button",{onClick:()=>p(t.id,"enabled",!t.enabled),className:`p-2 rounded-lg ${t.enabled?"text-green-400 bg-green-500/10":"text-zinc-600"}`,children:t.enabled?e.jsx(ae,{size:16}):e.jsx(ue,{size:16})}),e.jsx("button",{onClick:()=>m(t.id),className:"p-2 text-zinc-600 hover:text-red-400 hover:bg-red-500/10 rounded-lg",children:e.jsx(ee,{size:16})})]},t.id)),e.jsxs("button",{onClick:g,className:"w-full py-3 text-sm font-bold text-zinc-500 hover:text-white bg-zinc-800/50 hover:bg-zinc-800 rounded-lg transition-colors border border-dashed border-zinc-800",children:[e.jsx(re,{size:16,className:"inline mr-2"})," Add Proxy"]})]})]})}),u==="security"&&e.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsxs("section",{className:"space-y-8",children:[e.jsx("h2",{className:"text-lg font-bold text-white border-b border-zinc-800 pb-2",children:"Security & Vault"}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-emerald-500/10 text-emerald-500 rounded-full border border-emerald-500/20 shadow-[0_0_15px_rgba(16,185,129,0.2)]",children:e.jsx(Le,{size:24})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-bold text-white",children:"Encrypted Vault Active"}),e.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Your data is encrypted at rest using AES-GCM (Zero-Knowledge)."})]})]}),e.jsxs("button",{onClick:()=>window.location.reload(),className:"flex items-center gap-2 px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-zinc-200 rounded-lg text-xs font-bold transition-colors border border-zinc-700 hover:border-zinc-600",children:[e.jsx(Fe,{size:14})," Lock Vault (Reload)"]})]})]}),e.jsxs("section",{className:"space-y-8",children:[e.jsx("h2",{className:"text-lg font-bold text-white border-b border-zinc-800 pb-2",children:"Data Management"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:I,className:"flex items-center gap-4 p-5 bg-zinc-900 border border-zinc-800 hover:border-indigo-500 hover:bg-zinc-800 rounded-xl transition-all group text-left",children:[e.jsx("div",{className:"p-3 bg-black rounded-lg text-indigo-500 group-hover:text-white transition-colors",children:e.jsx(he,{size:24})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-white",children:"Backup Database"}),e.jsx("p",{className:"text-[10px] text-zinc-500 mt-1",children:"Download ZIP (JSON + Attachments)"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",ref:U,accept:".zip,.json",onChange:je,className:"hidden"}),e.jsxs("button",{onClick:()=>{var t;return(t=U.current)==null?void 0:t.click()},className:"w-full flex items-center gap-4 p-5 bg-zinc-900 border border-zinc-800 hover:border-emerald-500 hover:bg-zinc-800 rounded-xl transition-all group text-left",children:[e.jsx("div",{className:"p-3 bg-black rounded-lg text-emerald-500 group-hover:text-white transition-colors",children:ie?e.jsx(_e,{size:24,className:"animate-spin"}):e.jsx(Me,{size:24})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-white",children:"Restore Backup"}),e.jsx("p",{className:"text-[10px] text-zinc-500 mt-1",children:"Import ZIP or JSON file"})]})]})]})]}),e.jsxs("div",{className:"p-8 bg-red-500/20 border border-red-500/20 rounded-lg flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-zinc-500",children:[e.jsx("span",{className:"font-bold text-red-500 block mb-0.5",children:"Danger Zone"}),"Resetting the database will wipe all local data permanently."]}),e.jsx("button",{onClick:ve,className:"text-xs bg-red-900/30 hover:bg-red-900/50 text-red-500 border border-red-900/30 p-4 rounded-lg transition-colors font-bold",children:"Reset Database"})]})]})]}),u==="about"&&e.jsx("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-300",children:e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-bold text-white border-b border-zinc-800 pb-2",children:"About NotesDB"}),e.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-lg font-bold text-zinc-200 mb-2",children:"The Workflow"}),e.jsx("p",{className:"text-sm text-zinc-400 leading-relaxed",children:"NotesDB bridges the gap between raw data sources (XML/JSON) and a usable, searchable knowledge base. It is designed to work offline, storing all data securely in your browser."})]}),e.jsxs("div",{className:"grid gap-6 relative",children:[e.jsx("div",{className:"absolute left-[19px] top-8 bottom-8 w-0.5 bg-zinc-800"}),e.jsxs("div",{className:"relative flex gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-zinc-900 border border-zinc-700 flex items-center justify-center shrink-0 z-10",children:e.jsx(te,{size:18,className:"text-indigo-400"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-bold text-zinc-200",children:"1. Data Ingestion"}),e.jsxs("p",{className:"text-xs text-zinc-500 mt-1 leading-relaxed",children:["Fetch data directly from REST APIs or use a local ",e.jsx("strong",{children:"Proxy-web"})," to convert XML/RSS feeds into JSON. If using a local proxy, paste the JSON output directly to bypass browser CORS restrictions."]})]})]}),e.jsxs("div",{className:"relative flex gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-zinc-900 border border-zinc-700 flex items-center justify-center shrink-0 z-10",children:e.jsx(xe,{size:18,className:"text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-bold text-zinc-200",children:"2. Smart Mapping"}),e.jsxs("p",{className:"text-xs text-zinc-500 mt-1 leading-relaxed",children:["Define how raw JSON fields map to UI components (Rich Text, Images, Chips). Save these mappings as ",e.jsx("strong",{children:"Templates"})," for recurring imports."]})]})]}),e.jsxs("div",{className:"relative flex gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-zinc-900 border border-zinc-700 flex items-center justify-center shrink-0 z-10",children:e.jsx(Ie,{size:18,className:"text-emerald-400"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-bold text-zinc-200",children:"3. Encrypted Storage"}),e.jsxs("p",{className:"text-xs text-zinc-500 mt-1 leading-relaxed",children:["Data is stored in ",e.jsx("strong",{children:"IndexedDB"})," within your browser. An optional master password encrypts the database key, ensuring zero-knowledge privacy."]})]})]}),e.jsxs("div",{className:"relative flex gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-zinc-900 border border-zinc-700 flex items-center justify-center shrink-0 z-10",children:e.jsx(De,{size:18,className:"text-amber-400"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-bold text-zinc-200",children:"4. Agentic Research"}),e.jsxs("p",{className:"text-xs text-zinc-500 mt-1 leading-relaxed",children:["Activate local AI (WebLLM/Gemini Nano) or cloud providers to analyze your notes, find connections, and generate insights based on your defined ",e.jsx("strong",{children:"User Intent"}),"."]})]})]})]}),e.jsxs("div",{className:"mt-8 p-4 bg-zinc-950 border border-zinc-800 rounded-lg",children:[e.jsxs("h5",{className:"text-xs font-bold text-zinc-300 flex items-center gap-2 mb-2",children:[e.jsx(ce,{size:14}),"Technical Stack"]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"px-2 py-1 bg-zinc-900 rounded text-[10px] text-zinc-500 border border-zinc-800",children:"React 18"}),e.jsx("span",{className:"px-2 py-1 bg-zinc-900 rounded text-[10px] text-zinc-500 border border-zinc-800",children:"Vite"}),e.jsx("span",{className:"px-2 py-1 bg-zinc-900 rounded text-[10px] text-zinc-500 border border-zinc-800",children:"TypeScript"}),e.jsx("span",{className:"px-2 py-1 bg-zinc-900 rounded text-[10px] text-zinc-500 border border-zinc-800",children:"TailwindCSS"}),e.jsx("span",{className:"px-2 py-1 bg-zinc-900 rounded text-[10px] text-zinc-500 border border-zinc-800",children:"Dexie/IndexedDB"}),e.jsx("span",{className:"px-2 py-1 bg-zinc-900 rounded text-[10px] text-zinc-500 border border-zinc-800",children:"WebLLM"})]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-zinc-800 flex justify-center",children:e.jsxs("a",{href:"#",className:"text-xs text-indigo-400 hover:text-indigo-300 hover:underline flex items-center gap-1",children:["View Documentation ",e.jsx(Te,{size:10})]})})]})]})})]})}),L&&e.jsx(qe,{initialConfig:J,onClose:()=>{O(!1),$(void 0)},onSave:T})]})};export{as as default};
