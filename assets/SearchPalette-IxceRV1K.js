import{r as n,j as e,X as C,F as E,n as L,o as T,p as A}from"./index-DboLLwwP.js";import{S as R}from"./search-DXFRVerH.js";import{H as F}from"./hash-D4bagVh5.js";import"./vendor-B7FnPyzq.js";const O=({notes:f,categories:b,tags:x,onSelect:N,onClose:i,initialCategoryId:o,initialTagId:a})=>{const[p,w]=n.useState(""),[d,j]=n.useState(o||""),[l,g]=n.useState(a?new Set([a]):new Set),v=n.useRef(null);n.useEffect(()=>{var t;(t=v.current)==null||t.focus()},[]),n.useEffect(()=>{o&&j(o),a&&g(new Set([a]))},[o,a]),n.useEffect(()=>{const t=s=>{s.key==="Escape"&&i()};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[i]);const y=t=>{const s=new Set(l);s.has(t)?s.delete(t):s.add(t),g(s)},z=t=>t.replace(/<[^>]*>?/gm,""),m=n.useMemo(()=>{const t=p.toLowerCase();return f.filter(s=>{const h=z(s.content).toLowerCase(),r=s.title.toLowerCase(),c=!t||r.includes(t)||h.includes(t),u=!d||s.categoryId===d,S=l.size===0||Array.from(l).every(k=>s.tags.includes(k));return c&&u&&S})},[f,p,d,l]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[60]",onClick:i}),e.jsx("div",{className:"fixed top-12 left-1/2 -translate-x-1/2 w-full max-w-[600px] z-[70] animate-in fade-in slide-in-from-top-4 duration-200",children:e.jsxs("div",{className:"bg-zinc-900/95 backdrop-blur-xl border border-zinc-800 rounded-xl shadow-2xl flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 py-4 border-b border-zinc-800",children:[e.jsx(R,{className:"text-zinc-500",size:20}),e.jsx("input",{ref:v,type:"text",value:p,onChange:t=>w(t.target.value),placeholder:"Search notes...",className:"flex-1 bg-transparent text-lg text-white placeholder:text-zinc-600 outline-none"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] bg-zinc-800 text-zinc-500 px-1.5 py-0.5 rounded border border-zinc-700",children:"ESC"}),e.jsx("button",{onClick:i,className:"text-zinc-500 hover:text-white",children:e.jsx(C,{size:20})})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 px-4 py-3 bg-zinc-900/50 border-b border-zinc-800",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:d,onChange:t=>j(t.target.value),className:"appearance-none bg-black border border-zinc-700 rounded-lg text-xs text-white pl-8 pr-8 py-1.5 outline-none focus:border-indigo-500 cursor-pointer",children:[e.jsx("option",{value:"",children:"All Categories"}),b.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx(E,{size:12,className:"absolute left-2.5 top-2 text-zinc-500 pointer-events-none"}),e.jsx("div",{className:"absolute right-2.5 top-2 pointer-events-none text-zinc-500",children:"▼"})]}),e.jsxs("span",{className:"text-xs text-zinc-500 font-mono",children:[m.length," results"]})]}),x.length>0&&e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto custom-scrollbar pb-1",children:[e.jsx("span",{className:"text-[10px] font-bold text-zinc-600 uppercase shrink-0",children:"Tags:"}),x.map(t=>{const s=l.has(t.id);return e.jsxs("button",{onClick:()=>y(t.id),className:`
                                    flex items-center gap-1.5 px-2 py-1 rounded-full text-xs border transition-all shrink-0
                                    ${s?"bg-indigo-600 border-indigo-500 text-white":"bg-zinc-800 border-zinc-700 text-zinc-400 hover:text-zinc-200 hover:border-zinc-600"}
                                `,children:[e.jsx(F,{size:10}),t.name]},t.id)})]})]}),e.jsx("div",{className:"max-h-[400px] overflow-y-auto custom-scrollbar p-2 space-y-1",children:m.length===0?e.jsxs("div",{className:"py-12 text-center text-zinc-500",children:[e.jsx(L,{size:48,className:"mx-auto mb-3 opacity-20"}),e.jsx("p",{className:"text-sm",children:"No notes found matching your criteria."})]}):m.map(t=>{const s=b.find(r=>r.id===t.categoryId),h=z(t.content).substring(0,80)+"...";return e.jsxs("button",{onClick:()=>{N(t),i()},className:"w-full text-left p-3 rounded-lg hover:bg-zinc-800 border border-transparent hover:border-zinc-700 transition-all group",children:[e.jsxs("div",{className:"flex items-start justify-between mb-1",children:[e.jsx("h4",{className:"text-sm font-bold text-zinc-200 group-hover:text-white truncate pr-4",children:t.title}),s&&e.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded-sm border opacity-70 ${T[s.color]||"text-zinc-500 border-zinc-700"}`,children:s.name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-xs text-zinc-500 font-mono truncate flex-1",children:h}),e.jsx(A,{size:14,className:"text-zinc-700 group-hover:text-zinc-500 opacity-0 group-hover:opacity-100 transition-opacity"})]}),t.tags.length>0&&e.jsx("div",{className:"flex gap-1 mt-2",children:t.tags.slice(0,4).map(r=>{const c=x.find(u=>u.id===r);return c?e.jsx("span",{className:"w-1.5 h-1.5 rounded-full",style:{backgroundColor:c.color==="zinc"?"#71717a":c.color},title:c.name},r):null})})]},t.id)})}),e.jsxs("div",{className:"px-4 py-2 bg-zinc-950 border-t border-zinc-800 flex justify-between items-center text-[10px] text-zinc-600",children:[e.jsx("span",{children:"Navigate with filters"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("span",{children:["Search: ",e.jsx("strong",{children:"Title"})," & ",e.jsx("strong",{children:"Content"})]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Tags: ",e.jsx("strong",{children:"AND"})," Logic"]})]})]})]})})]})};export{O as default};
