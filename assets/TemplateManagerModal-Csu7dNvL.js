import{r as i,j as e,aa as z,g as w,X as y,a2 as u,a as k,ac as C,d as o}from"./index-BewSTdif.js";import{S}from"./search-DoIgd_XR.js";import"./vendor-B7FnPyzq.js";const F=({onClose:d,onSelect:b,sampleItem:f,initialMappings:r,targetTemplateId:a})=>{const[g,x]=i.useState([]),[m,j]=i.useState(""),[t,l]=i.useState(null);i.useEffect(()=>{(async()=>{const n=await o.getTemplates();if(x(n),a&&a!=="smart"){const c=n.find(N=>N.id===a);if(c){l({...c,rules:r||c.rules});return}}if(r&&!a){p(r);return}})()},[a]);const p=(s=[])=>{const n={id:crypto.randomUUID(),name:"New Template",rules:s};l(n)},v=async()=>{if(!t||!t.name.trim())return;await o.saveTemplate(t);const s=await o.getTemplates();x(s),b(t)},h=g.filter(s=>s.name.toLowerCase().includes(m.toLowerCase()));return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"w-full max-w-6xl bg-black border border-zinc-800 rounded-xl shadow-2xl overflow-hidden flex h-[85vh]",children:[e.jsxs("div",{className:"w-64 border-r border-zinc-800 bg-zinc-900/50 flex flex-col shrink-0",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-800",children:[e.jsxs("h3",{className:"text-sm font-bold text-zinc-200 mb-3 flex items-center gap-2",children:[e.jsx(z,{size:16,className:"text-indigo-500"})," Templates"]}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{size:12,className:"absolute left-2.5 top-2.5 text-zinc-500"}),e.jsx("input",{value:m,onChange:s=>j(s.target.value),placeholder:"Search templates...",className:"w-full bg-black border border-zinc-800 rounded-lg py-1.5 pl-8 pr-2 text-xs text-white focus:border-indigo-500 outline-none"})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-2 space-y-1 custom-scrollbar",children:[h.map(s=>e.jsxs("button",{onClick:()=>l({...s}),className:`w-full text-left px-3 py-2 rounded-lg text-xs transition-colors flex items-center justify-between group ${(t==null?void 0:t.id)===s.id?"bg-indigo-600 text-white":"text-zinc-400 hover:bg-zinc-800 hover:text-zinc-200"}`,children:[e.jsx("span",{className:"truncate font-medium",children:s.name}),e.jsxs("span",{className:"text-[9px] opacity-70 bg-black/20 px-1.5 rounded",children:[s.rules.length," blocks"]})]},s.id)),h.length===0&&e.jsx("p",{className:"text-center text-[10px] text-zinc-600 py-4",children:"No templates found."})]}),e.jsx("div",{className:"p-4 border-t border-zinc-800",children:e.jsxs("button",{onClick:()=>p(),className:"w-full flex items-center justify-center gap-2 bg-zinc-800 hover:bg-zinc-700 text-zinc-200 py-2 rounded-lg text-xs font-bold transition-colors border border-zinc-700",children:[e.jsx(w,{size:14})," Create Blank"]})})]}),e.jsxs("div",{className:"flex-1 bg-zinc-950 flex flex-col min-w-0 relative",children:[e.jsx("button",{onClick:d,className:"absolute top-4 right-4 text-zinc-500 hover:text-white p-2 z-20",children:e.jsx(y,{size:20})}),t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-6 border-b border-zinc-800 flex items-center gap-4 shrink-0",children:[e.jsx("div",{className:"p-3 bg-indigo-500/10 rounded-xl text-indigo-400",children:e.jsx(u,{size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-zinc-500 uppercase",children:"Template Name"}),e.jsx("input",{value:t.name,onChange:s=>l({...t,name:s.target.value}),className:"w-full bg-transparent text-xl font-bold text-white outline-none placeholder:text-zinc-700",placeholder:"Untitled Template",autoFocus:t.name==="New Template"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:d,className:"px-4 py-2 text-zinc-400 hover:text-white text-xs font-bold transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-xs font-bold transition-all shadow-lg shadow-indigo-900/20",children:[e.jsx(k,{size:14}),"Save Template"]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(C,{selectedItems:[f],mappings:t.rules,onMappingsChange:s=>l({...t,rules:s})})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-zinc-600",children:[e.jsx(u,{size:48,className:"opacity-20 mb-4"}),e.jsx("p",{className:"text-sm",children:"Select a template to edit or create a new one."})]})]})]})})};export{F as default};
